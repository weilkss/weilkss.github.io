(this["webpackJsonpweilkss.github.io"]=this["webpackJsonpweilkss.github.io"]||[]).push([[20],{213:function(e,t,n){"use strict";var a=n(35);var i=n(66);function o(e){return function(e){if(Array.isArray(e))return Object(a.a)(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||Object(i.a)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}n.d(t,"a",(function(){return o}))},219:function(e,t,n){},220:function(e,t){!function(e){var t='<svg><symbol id="icon-loading" viewBox="0 0 1024 1024"><path d="M960 447.008q-11.008-152.992-120-261.504t-260.992-120.512q-16-0.992-27.488 9.504t-11.488 26.496q0 14.016 9.504 24.512t23.488 11.488q55.008 4 107.008 26.016 60.992 26.016 108.992 73.504t74.016 109.504q22.016 51.008 26.016 106.016 0.992 14.016 11.488 23.488t24.512 9.504q15.008 0 26.016-11.008 11.008-12 8.992-27.008z"  ></path></symbol><symbol id="icon-check-circle-fill" viewBox="0 0 1024 1024"><path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64z m193.5 301.7l-210.6 292c-12.7 17.7-39 17.7-51.7 0L318.5 484.9c-3.8-5.3 0-12.7 6.5-12.7h46.9c10.2 0 19.9 4.9 25.9 13.3l71.2 98.8 157.2-218c6-8.3 15.6-13.3 25.9-13.3H699c6.5 0 10.3 7.4 6.5 12.7z"  ></path></symbol><symbol id="icon-close-circle-fill" viewBox="0 0 1024 1024"><path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64z m165.4 618.2l-66-0.3L512 563.4l-99.3 118.4-66.1 0.3c-4.4 0-8-3.5-8-8 0-1.9 0.7-3.7 1.9-5.2l130.1-155L340.5 359c-1.2-1.5-1.9-3.3-1.9-5.2 0-4.4 3.6-8 8-8l66.1 0.3L512 464.6l99.3-118.4 66-0.3c4.4 0 8 3.5 8 8 0 1.9-0.7 3.7-1.9 5.2L553.5 514l130 155c1.2 1.5 1.9 3.3 1.9 5.2 0 4.4-3.6 8-8 8z"  ></path></symbol><symbol id="icon-info-circle-fill" viewBox="0 0 1024 1024"><path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64z m32 664c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V456c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v272z m-32-344c-26.5 0-48-21.5-48-48s21.5-48 48-48 48 21.5 48 48-21.5 48-48 48z"  ></path></symbol><symbol id="icon-warning-circle-fill" viewBox="0 0 1024 1024"><path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64z m-32 232c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v272c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V296z m32 440c-26.5 0-48-21.5-48-48s21.5-48 48-48 48 21.5 48 48-21.5 48-48 48z"  ></path></symbol></svg>',n=function(){var e=document.getElementsByTagName("script");return e[e.length-1]}().getAttribute("data-injectcss");if(n&&!e.__iconfont__svg__cssinject__){e.__iconfont__svg__cssinject__=!0;try{document.write("<style>.svgfont {display: inline-block;width: 1em;height: 1em;fill: currentColor;vertical-align: -0.1em;font-size:16px;}</style>")}catch(a){console&&console.log(a)}}!function(t){if(document.addEventListener)if(~["complete","loaded","interactive"].indexOf(document.readyState))setTimeout(t,0);else{document.addEventListener("DOMContentLoaded",(function e(){document.removeEventListener("DOMContentLoaded",e,!1),t()}),!1)}else document.attachEvent&&function(e,t){var n=e.document,i=!1,o=function(){i||(i=!0,t())};(function e(){try{n.documentElement.doScroll("left")}catch(a){return void setTimeout(e,50)}o()})(),n.onreadystatechange=function(){"complete"==n.readyState&&(n.onreadystatechange=null,o())}}(e,t)}((function(){var e,n,a,i;(e=document.createElement("div")).innerHTML=t,t=null,(n=e.getElementsByTagName("svg")[0])&&(n.setAttribute("aria-hidden","true"),n.style.position="absolute",n.style.width=0,n.style.height=0,n.style.overflow="hidden",a=n,(i=document.body).firstChild?function(e,t){t.parentNode.insertBefore(e,t)}(a,i.firstChild):i.appendChild(a))}))}(window)},222:function(e,t,n){"use strict";var a=n(57),i=n(58),o=n(61),c=n(59),r=n(60),l=n(0),s=n.n(l),u=n(64),d=n.n(u),m=n(633),h=n(631),f=function(e){Object(r.a)(n,e);var t=Object(c.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"render",value:function(){var e=this.props,t=e.type,n=e.content;return s.a.createElement("div",{className:"toast-notice ".concat(t)},s.a.createElement("svg",{className:"icon","aria-hidden":"true"},s.a.createElement("use",{xlinkHref:"#".concat({info:"icon-info-circle-fill",success:"icon-check-circle-fill",warning:"icon-warning-circle-fill",error:"icon-close-circle-fill",loading:"icon-loading"}[t])})),s.a.createElement("span",null,n))}}]),n}(l.Component),p=function(e){Object(r.a)(n,e);var t=Object(c.a)(n);function n(){var e;return Object(a.a)(this,n),(e=t.call(this)).transitionTime=300,e.state={notices:[]},e.removeNotice=e.removeNotice.bind(Object(o.a)(e)),e}return Object(i.a)(n,[{key:"getNoticeKey",value:function(){var e=this.state.notices;return"notice-".concat((new Date).getTime(),"-").concat(e.length)}},{key:"addNotice",value:function(e){var t=this,n=this.state.notices;return e.key=this.getNoticeKey(),n.every((function(t){return t.key!==e.key}))&&(n.length>0&&"loading"===n[n.length-1].type?(n.push(e),setTimeout((function(){t.setState({notices:n})}),this.transitionTime)):(n.push(e),this.setState({notices:n})),e.duration>0&&setTimeout((function(){t.removeNotice(e.key)}),e.duration)),function(){t.removeNotice(e.key)}}},{key:"removeNotice",value:function(e){var t=this,n=this.state.notices;this.setState({notices:n.filter((function(n){return n.key!==e||(n.onClose&&setTimeout(n.onClose,t.transitionTime),!1)}))})}},{key:"render",value:function(){var e=this,t=this.state.notices;return s.a.createElement(m.a,{className:"toast-notification"},t.map((function(t){return s.a.createElement(h.a,{key:t.key,classNames:"toast-notice-wrapper notice",timeout:e.transitionTime},s.a.createElement(f,t))})))}}]),n}(l.Component);var v,g=function(){var e=document.createElement("div");document.body.appendChild(e);var t=s.a.createRef();return d.a.render(s.a.createElement(p,{ref:t}),e),{addNotice:function(e){return t.current.addNotice(e)},destroy:function(){d.a.unmountComponentAtNode(e),document.body.removeChild(e)}}}(),y=(n(219),function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2e3,a=arguments.length>3?arguments[3]:void 0;return v||(v=g),v.addNotice({type:e,content:t,duration:n,onClose:a})}),b={info:function(e,t,n){return y("info",e,t,n)},success:function(e,t,n){return y("success",e,t,n)},warning:function(e,t,n){return y("warning",e,t,n)},error:function(e,t,n){return y("error",e,t,n)},loading:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0;return y("loading",e,t,n)},destroy:function(){return v||(v=g),v.destroy()}};n(220),t.a=b},233:function(e,t,n){},627:function(e,t,n){"use strict";n.r(t);var a=n(29),i=n.n(a),o=n(213),c=n(53),r=n(57),l=n(58),s=n(61),u=n(59),d=n(60),m=n(0),h=n.n(m),f=n(243),p=n.n(f),v=n(37),g=n(62),y=n(222),b=(n(233),function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(){var e;return Object(r.a)(this,n),(e=t.call(this)).state={title:"",describe:"",atlas:[]},e.handleTitle=function(t){e.setState({title:t.target.value.trim()})},e.handletextChange=function(t){e.setState({describe:t.target.value.trim()})},e.uploadFunc=e.uploadFunc.bind(Object(s.a)(e)),e.handleReple=e.handleReple.bind(Object(s.a)(e)),e}return Object(l.a)(n,[{key:"uploadFunc",value:function(){var e=Object(c.a)(i.a.mark((function e(t,n){var a,c,r,l,s,u,d,m,h=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.state.atlas,c={narrow:"",url:"",width:100,height:100},r=new FormData,l=new FormData,e.next=6,this.compressImg(t[n]);case 6:return s=e.sent,u=s.cfile,d=s.originHeight,m=s.originWidth,c.width=m,c.height=d,l.append("token",v.a.qiniu.token),l.append("key",(new Date).getTime()+"-"+t[n].name),l.append("file",u),e.next=17,p.a.post(v.a.qiniu.uploadUrl,l,{"Content-Type":"multipart/form-data"}).then((function(e){c.narrow=e.data.key}));case 17:return r.append("token",v.a.qiniu.token),r.append("key",(new Date).getTime()+"-"+t[n].name),r.append("file",t[n]),e.next=22,p.a.post(v.a.qiniu.uploadUrl,r,{"Content-Type":"multipart/form-data"}).then((function(e){c.url=e.data.key}));case 22:a=[c].concat(Object(o.a)(a)),this.setState({atlas:a},(function(){n<t.length-1&&h.uploadFunc(t,n+1)}));case 24:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"handleUpload",value:function(e){e.target.files.length&&this.uploadFunc(e.target.files,0)}},{key:"compressImg",value:function(e){return new Promise((function(t){var n=new FileReader,a=new Image;n.readAsDataURL(e),n.onload=function(e){a.src=e.target.result},a.onload=function(){var e=document.createElement("canvas"),n=e.getContext("2d"),i=this.width,o=this.height,c=i,r=o;(i>100||o>100)&&(i/o>1?(c=100,r=Math.round(o/i*100)):(r=100,c=Math.round(i/o*100))),e.width=c,e.height=r,n.clearRect(0,0,c,r),n.drawImage(a,0,0,c,r);for(var l=e.toDataURL("image/jpeg",.92).split(","),s=l[0].match(/:(.*?);/)[1],u=s.split("/")[1],d=atob(l[1]),m=d.length,h=new Uint8Array(m);m--;)h[m]=d.charCodeAt(m);t({cfile:new File([h],"file.".concat(u),{type:s}),originWidth:i,originHeight:o})}}))}},{key:"handleReple",value:function(){var e=this;g.a.setAtlas(this.state).then((function(t){y.a.success("\u53d1\u5e03\u6210\u529f!"),setTimeout((function(){e.props.history.push("/atlas")}),2e3)}))}},{key:"render",value:function(){var e=this;return h.a.createElement("div",{className:"upload"},h.a.createElement("p",{className:"upload-title"},"\u4e0a\u4f20\u56fe\u96c6&TEST"),h.a.createElement("div",{className:"upload-top"},h.a.createElement("input",{className:"upload-name",type:"text",placeholder:"\u6807\u9898",onChange:this.handleTitle}),h.a.createElement("button",{className:"upload-reple",onClick:this.handleReple},"\u53d1\u5e03")),h.a.createElement("textarea",{className:"upload-describe",placeholder:"\u8f93\u5165\u63cf\u8ff0",onChange:this.handletextChange}),h.a.createElement("div",{className:"upload-btn"},h.a.createElement("input",{className:"upload-input",type:"file",multiple:!0,accept:".jpg,.jpeg,.png,.gif",onChange:function(t){return e.handleUpload(t)}}),h.a.createElement("i",{className:"xwb iconshangchuan"}),h.a.createElement("p",null,"\u4e0a\u4f20\u56fe\u96c6\u3010\u53ef\u591a\u9009\u3011")),h.a.createElement("div",{className:"upload-img-box"},this.state.atlas.map((function(e,t){return h.a.createElement("img",{className:"upload-img",src:v.a.qiniu.domian+e.narrow,alt:"",key:t})}))))}}]),n}(h.a.Component));t.default=b}}]);